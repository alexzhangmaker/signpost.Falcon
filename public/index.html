<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1 , viewport-fit=cover">
  <meta name="mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">

  <title>signpost.Falcon</title>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/css/bootstrap.min.css" rel="stylesheet">
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.5.0/font/bootstrap-icons.css">
  <link href="https://fonts.googleapis.com/css?family=Montserrat&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Material+Symbols+Outlined:opsz,wght,FILL,GRAD@20..48,100..700,0..1,-50..200" />
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/js/bootstrap.bundle.min.js"></script>

  <!-- APP Manifest  -->
  <link rel="manifest" href="/manifest.json">

  <style>
    .falconCards{
      font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
    }

    .signpostFlex{
      display: flex;
      flex-direction: row;
      flex-wrap: nowrap;
      justify-content: space-between;
      align-items: normal;
      align-content: normal;
    }


    .falconCard .table-responsive{
      max-height: 200px;
    }

    .falconButton:hover{
      cursor: pointer;
    }

  </style>
<style>
	/* Custom style */
    .accordion-button::after {
      background-image: url("data:image/svg+xml,%3csvg viewBox='0 0 16 16' fill='%23333' xmlns='http://www.w3.org/2000/svg'%3e%3cpath fill-rule='evenodd' d='M8 0a1 1 0 0 1 1 1v6h6a1 1 0 1 1 0 2H9v6a1 1 0 1 1-2 0V9H1a1 1 0 0 1 0-2h6V1a1 1 0 0 1 1-1z' clip-rule='evenodd'/%3e%3c/svg%3e");
      transform: scale(.7) !important;
    }
    .accordion-button:not(.collapsed)::after {
      background-image: url("data:image/svg+xml,%3csvg viewBox='0 0 16 16' fill='%23333' xmlns='http://www.w3.org/2000/svg'%3e%3cpath fill-rule='evenodd' d='M0 8a1 1 0 0 1 1-1h14a1 1 0 1 1 0 2H1a1 1 0 0 1-1-1z' clip-rule='evenodd'/%3e%3c/svg%3e");
    }

    
    .accordion-button:not(.collapsed){
      background-color: none !important;
    }

</style>
</head>
<body>

  <nav class="navbar sticky-top navbar-expand-lg navbar-light bg-light">
      <div class="container-fluid">
          <a href="#" class="navbar-brand">
              <img src="images/icons/falcon-64.png" height="28" alt="falcon">
          </a>
          <button type="button" class="navbar-toggler" data-bs-toggle="collapse" data-bs-target="#navbarCollapse">
              <span class="navbar-toggler-icon"></span>
          </button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
              <div class="navbar-nav">
                  <a href="#" class="nav-item nav-link active">Money Man</a>
                  <a href="#" class="nav-item nav-link">Profile</a>
                  <a href="#" class="nav-item nav-link">Messages</a>
                  <a href="#" class="nav-item nav-link disabled" tabindex="-1">Reports</a>
              </div>
              <div class="navbar-nav ms-auto">
                  <a href="#" class="nav-item nav-link">Login</a>
              </div>
          </div>
      </div>
  </nav>

  <div class="m-4">
    <div class="row row-cols-1 row-cols-md-2 g-4 falconCards" >


      <div class='col fcPortfolio fcAccordion falconCard'>
        <div class="card border-success">
          <div class="card-header signpostFlex">
            <div>
              <i class="bi-bar-chart-line-fill" style="font-size: 24px;"></i>
              <span>纵览</span>
            </div>
            <div>
              <span>win $2050.00</span>
              <i class="bi-graph-up" style="color: orangered;font-size: 24px;"></i>
            </div>

          </div>

          <div class="card-body">
              
              <div class="accordion" id="myAccordion">


                <div class="accordion-item">
                    <h2 class="accordion-header" id="headingOne">
                        <button type="button" class="accordion-button collapsed" data-bs-toggle="collapse" data-bs-target="#collapseOne">
                          <div class="signpostFlex" style="width:80%;">
                            <div>海通证券</div>
                            <div class="signpostFlex" style="width: 30%;">
                              <div>+0.16%</div>
                              <div>+CNY200.00</div>
                            </div>
                          </div>
                        </button>									
                    </h2>
                    <div id="collapseOne" class="accordion-collapse collapse" data-bs-parent="#myAccordion">
                        <div class="card-body">
                          <div class="table-responsive falconAssetTbl"> 
                            <table class="table">
                                <tbody>
                                    <tr>
                                        <td>Equity</td>
                                        <td>1,200,000</td>
                                    </tr>
                                    <tr>
                                      <td>Debt</td>
                                      <td>HKD 100,000</td>
                                    </tr>
                                    <tr>
                                      <td>Cash</td>
                                      <td>CNY 20,000</td>
                                    </tr>
                                    <tr>
                                      <td>P/L</td>
                                      <td>+130,000[CNY]</td>
                                    </tr>
                                    <tr>
                                      <td>P/L %</td>
                                      <td>11.14%</td>
                                    </tr>
                                </tbody>
                            </table>
                        </div> 
                        </div>
                    </div>
                </div>

                <div class="accordion-item">
                    <h2 class="accordion-header" id="headingTwo">
                        <button type="button" class="accordion-button collapsed" data-bs-toggle="collapse" data-bs-target="#collapseTwo">
                          <div class="signpostFlex" style="width:80%;">
                            <div>IBKR0085</div>
                            <div class="signpostFlex" style="width: 30%;">
                              <div>+0.16%</div>
                              <div>+CNY200.00</div>
                            </div>
                          </div>                        
                        </button>
                    </h2>
                    <div id="collapseTwo" class="accordion-collapse collapse" data-bs-parent="#myAccordion">
                        <div class="card-body">
                          <div class="table-responsive falconAssetTbl"> 
                            <table class="table">
                                <tbody>
                                    <tr>
                                        <td>Equity</td>
                                        <td>1,200,000</td>
                                    </tr>
                                    <tr>
                                      <td>Debt</td>
                                      <td>HKD 100,000</td>
                                    </tr>
                                    <tr>
                                      <td>Cash</td>
                                      <td>CNY 20,000</td>
                                    </tr>
                                    <tr>
                                      <td>P/L</td>
                                      <td>+130,000[CNY]</td>
                                    </tr>
                                    <tr>
                                      <td>P/L %</td>
                                      <td>11.14%</td>
                                    </tr>
                                </tbody>
                            </table>
                        </div>                         </div>
                    </div>
                </div>

                <div class="accordion-item">
                    <h2 class="accordion-header" id="headingThree">
                        <button type="button" class="accordion-button collapsed" data-bs-toggle="collapse" data-bs-target="#collapseThree">
                          <div class="signpostFlex" style="width:80%;">
                            <div>IBKR1169</div>
                            <div class="signpostFlex" style="width: 30%;">
                              <div>-0.76%</div>
                              <div>-$205</div>
                            </div>
                          </div>  
                        </button>                     
                    </h2>
                    <div id="collapseThree" class="accordion-collapse collapse" data-bs-parent="#myAccordion">
                        <div class="card-body">
                          <div class="table-responsive falconAssetTbl"> 
                            <table class="table">
                                <tbody>
                                    <tr>
                                        <td>Equity</td>
                                        <td>1,200,000</td>
                                    </tr>
                                    <tr>
                                      <td>Debt</td>
                                      <td>HKD 100,000</td>
                                    </tr>
                                    <tr>
                                      <td>Cash</td>
                                      <td>CNY 20,000</td>
                                    </tr>
                                    <tr>
                                      <td>P/L</td>
                                      <td>+130,000[CNY]</td>
                                    </tr>
                                    <tr>
                                      <td>P/L %</td>
                                      <td>11.14%</td>
                                    </tr>
                                </tbody>
                            </table>
                        </div>                         </div>
                    </div>
                </div>

            </div>
              
          </div>
          <div class="card-footer text-muted signpostFlex">
            <span style="font-size: 12px;">2023/10/29</span>
            <i class="bi-info-circle"></i>
            
          </div>
        </div>
      </div>


      <div class='col fcPortfolio falconCard'>
        <div class="card border-success">
          <div class="card-header signpostFlex">
            <div>
              <i class="bi-bar-chart-line-fill" style="font-size: 24px;"></i>
              <span>纵览</span>
            </div>
            <div>
              <span>win $2050.00</span>
              <i class="bi-graph-up" style="color: orangered;font-size: 24px;"></i>
            </div>

          </div>

          <div class="card-body">
              <p class="card-text">NASA launched Parker space probe in 2018 with the mission of making observations of the outer corona of the Sun. It is the first-ever mission to "touch" the Sun.</p>
              <div class="table-responsive"> 
                <table class="table">
                    <thead>
                        <tr>
                            
                            <th>Account</th>
                            <th>Value TTM</th>
                            <th>Gain/Loss</th>
                            <th>G/L %</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td>U1234567</td>
                            <td>$780,000</td>
                            <td>1560.00</td>
                            <td>0.67%</td>
                        </tr>
                        <tr>
                          <td>U1234567</td>
                            <td>$780,000</td>
                            <td>1560.00</td>
                            <td>0.67%</td>
                        </tr>
                        <tr>
                          <td>U1234567</td>
                          <td>$780,000</td>
                          <td>1560.00</td>
                          <td>0.67%</td>
                        </tr>
                        <tr>
                          <td>海通证券</td>
                          <td>RMB280,000</td>
                          <td>-156.00</td>
                          <td>-0.91%</td>
                        </tr>
                        <tr style="color: orchid; font-weight: bold;">
                          <td>Total[RMB]</td>
                          <td>RMB1280,000</td>
                          <td>-156.00</td>
                          <td>-0.21%</td>
                        </tr>
                        <tr style="color:firebrick;font-family: Georgia, 'Times New Roman', Times, serif;">
                          <td>Total[USD]</td>
                          <td>$280,000</td>
                          <td>-156.00</td>
                          <td>-0.21%</td>
                        </tr>
                    </tbody>
                </table>
            </div> 
          </div>
          <div class="card-footer text-muted signpostFlex">
            <span style="font-size: 12px;">2023/10/29</span>
            <i class="bi-info-circle"></i>
            
          </div>
        </div>
      </div>
          
      <div class='col fcAccount falconCard'>
        <div class="card border-success">
          <div class="card-header signpostFlex">
            <div>
              <i class="bi-bar-chart-line-fill" style="font-size: 24px;"></i>
              <span>资产账户</span>

            </div>
            <div>
              <span>海通证券 -CNY2050.00</span>
              <i class="bi-graph-up" style="color: orangered;font-size: 24px;"></i>
            </div>

          </div>

          <div class="card-body">
              <p class="card-text">NASA launched Parker space probe in 2018 with the mission of making observations of the outer corona of the Sun. It is the first-ever mission to "touch" the Sun.</p>
              <div class="table-responsive"> 
                <table class="table">
                    <thead>
                        <tr>
                            <th>ticker</th>
                            <th>Company</th>
                            <th>Shares</th>
                            <th>Cost</th>
                            <th>Price</th>
                            <th>P/L </th>
                            <th>P/L %</th>
                            <th>Value</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td>SH600600</td>
                            <td>长江电力</td>
                            <td>1200</td>
                            <td>12.21</td>
                            <td>20.20</td>
                            <td>2022.00</td>
                            <td>2.1%</td>
                            <td>24,000</td>
                        </tr>
                        <tr>
                            <td>SH600600</td>
                            <td>中国平安</td>
                            <td>1200</td>
                            <td>12.21</td>
                            <td>20.20</td>
                            <td>2022.00</td>
                            <td>2.1%</td>
                            <td>24,000</td>
                        </tr>
                        <tr>
                            <td>SH600600</td>
                            <td>长江基建集团</td>
                            <td>1200</td>
                            <td>12.21</td>
                            <td>20.20</td>
                            <td>2022.00</td>
                            <td>2.1%</td>
                            <td>24,000</td>
                        </tr>
                        <tr>
                            <td>SH600600</td>
                            <td>腾讯科技</td>
                            <td>1200</td>
                            <td>12.21</td>
                            <td>20.20</td>
                            <td>2022.00</td>
                            <td>2.1%</td>
                            <td>24,000</td>
                        </tr>
                        
                    </tbody>
                </table>
            </div> 
          </div>
          <div class="card-footer text-muted signpostFlex">
            <span style="font-size: 12px;">2023/10/29</span>
            <i class="bi-info-circle"></i>
            
          </div>
        </div>
      </div>
      
      <div class='col fcExpenditure falconCard'>
        <div class="card border-success">
          <div class="card-header signpostFlex">
            <div>
              <i class="bi-currency-exchange" style="font-size: 24px;"></i>
              <span>当月开支</span>

            </div>
            <div>
              <span>till 2023/10/21</span>
              <i class="bi-graph-up" style="color: orangered;font-size: 24px;"></i>
            </div>
  
          </div>
  
          <div class="card-body">
              <p class="card-text">NASA launched Parker space probe in 2018 with the mission of making observations of the outer corona of the Sun. It is the first-ever mission to "touch" the Sun.</p>
              <div class="table-responsive"> 
                <table class="table">
                    <thead>
                        <tr>
                            <th>date</th>
                            <th>pay for</th>
                            <th>class</th>
                            <th>regular?</th>
                            <th>amount</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td>2023/10/21</td>
                            <td>Gasline</td>
                            <td>transportation</td>
                            <td>none</td>
                            <td>THB1052.00</td>
                        </tr>
                        <tr>
                            <td>2023/10/25</td>
                            <td>Dinner</td>
                            <td>Food</td>
                            <td>none</td>
                            <td>THB352.00</td>
                        </tr>
                        <tr>
                            <td>2023/10/26</td>
                            <td>Power</td>
                            <td>Utility</td>
                            <td>monthly</td>
                            <td>THB8052.00</td>

                        </tr>
                        <tr>
                            <td>2023/10/4</td>
                            <td>Water</td>
                            <td>Utility</td>
                            <td>monthly</td>
                            <td>THB1098.00</td>
                        </tr>
                        <tr>
                          <td>2023/10/26</td>
                          <td>Mobile</td>
                          <td>Utility</td>
                          <td>monthly</td>
                          <td>THB550.00</td>
                        </tr>
                        <tr>
                          <td>2023/10/26</td>
                          <td>INTERNET</td>
                          <td>Utility</td>
                          <td>monthly</td>
                          <td>THB650.00</td>

                      </tr>
                        <tr style="color: orchid; font-weight: bold;">
                            <td>2023/10/21</td>
                            <td>/</td>
                            <td>/</td>
                            <td>/</td>
                            <td>THB8052.00</td>

                        </tr>
                          
                    </tbody>
                </table>
            </div> 
          </div>
          <div class="card-footer text-muted signpostFlex">
            <span style="font-size: 12px;">2023/10/29</span>
            <i class="bi-info-circle"></i>
            
          </div>
        </div>
      </div>


      <div class='col fcExpenditure falconCard'>
        <div class="card border-success">
          <div class="card-header signpostFlex">
            <div><i class="bi-currency-exchange" style="font-size: 24px;"></i></div>
            <div>
              <span>till 2023/10/21</span>
              <i class="bi-graph-up" style="color: orangered;font-size: 24px;"></i>
            </div>
  
          </div>
  
          <div class="card-body">
              <p class="card-text">NASA launched Parker space probe in 2018 with the mission of making observations of the outer corona of the Sun. It is the first-ever mission to "touch" the Sun.</p>
              <div class="table-responsive"> 
                <table class="table">
                    <thead>
                        <tr>
                            <th>date</th>
                            <th>pay for</th>
                            <th>class</th>
                            <th>regular?</th>
                            <th>amount</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td>2023/10/21</td>
                            <td>Gasline</td>
                            <td>transportation</td>
                            <td>none</td>
                            <td>THB1052.00</td>
                        </tr>
                        <tr>
                            <td>2023/10/25</td>
                            <td>Dinner</td>
                            <td>Food</td>
                            <td>none</td>
                            <td>THB352.00</td>
                        </tr>
                        <tr>
                            <td>2023/10/26</td>
                            <td>Power</td>
                            <td>Utility</td>
                            <td>monthly</td>
                            <td>THB8052.00</td>

                        </tr>
                        <tr>
                            <td>2023/10/4</td>
                            <td>Water</td>
                            <td>Utility</td>
                            <td>monthly</td>
                            <td>THB1098.00</td>
                        </tr>
                        <tr>
                          <td>2023/10/26</td>
                          <td>Mobile</td>
                          <td>Utility</td>
                          <td>monthly</td>
                          <td>THB550.00</td>
                        </tr>
                        <tr>
                          <td>2023/10/<span contenteditable="true">21</span></td>
                          <td>
                            <div class="btn-group">
                              <button type="button" class="btn btn-primary dropdown-toggle" data-bs-toggle="dropdown">payment</button>
                              <div class="dropdown-menu">
                                  <a href="#" class="dropdown-item">internet</a>
                                  <a href="#" class="dropdown-item">mobile</a>
                                  <a href="#" class="dropdown-item">gasline</a>
                                  <div class="dropdown-header">power</div>
                                  <a href="#" class="dropdown-item">Clothing</a>
                                  <a href="#" class="dropdown-item">food</a>
                            </div>
                          </td>
                          <td>Utility</td>
                          <td>monthly</td>
                          <td>THB<span contenteditable="true">200.00</span></td>
                        </tr>
                        <tr style="color: orchid; font-weight: bold;">
                            <td>2023/10/21</td>
                            <td>/</td>
                            <td>/</td>
                            <td>/</td>
                            <td>THB8052.00</td>

                        </tr>
                          
                    </tbody>
                </table>
            </div> 
          </div>
          <div class="card-footer text-muted signpostFlex">
            <span style="font-size: 12px;">2023/10/29</span>
            <div>
            <i class="bi-plus-square falconButton" id="idBTNNewSpending"></i>   
            <i class="bi-check-square"></i>         
          </div>
          </div>
        </div>
      </div>

      <div class='col fcMonthlyBalance falconCard'>
        <div class="card border-success">
          <div class="card-header signpostFlex">
            <div>
              <i class="bi-currency-exchange" style="font-size: 24px;"></i>
              <span>逐月收支</span>
            </div>
            <div>
              <span>till 2023/10/21</span>
              <i class="bi-graph-up" style="color: orangered;font-size: 24px;"></i>
            </div>
  
          </div>
  
          <div class="card-body">
              <p class="card-text">NASA launched Parker space probe in 2018 with the mission of making observations of the outer corona of the Sun. It is the first-ever mission to "touch" the Sun.</p>
              <div class="table-responsive"> 
                <table class="table">
                    <thead>
                        <tr>
                            <th>Month</th>
                            <th>Income</th>
                            <th>Spending</th>
                            <th>结余</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td>Jan.2023</td>
                            <td>$10</td>
                            <td>THB 10,000</td>
                            <td>-RMB 1,700</td>
                        </tr>
                        <tr>
                          <td>Feb.2023</td>
                          <td>$10</td>
                          <td>THB 10,000</td>
                          <td>-RMB 1,700</td>
                        </tr><tr>
                          <td>Mar.2023</td>
                          <td>$10</td>
                          <td>THB 10,000</td>
                          <td>-RMB 1,700</td>
                        </tr><tr>
                          <td>Apr.2023</td>
                          <td>$10</td>
                          <td>THB 10,000</td>
                          <td>-RMB 1,700</td>
                      </tr>
                          
                    </tbody>
                </table>
            </div> 
          </div>
          <div class="card-footer text-muted signpostFlex">
            <span style="font-size: 12px;">2023/10/29</span>
            <div>
              <i class="bi-info-circle" style="font-size: 18px;"></i>   
            </div>
          </div>
        </div>
      </div>



    </div>
</div>

<div id="myModal" class="modal fade" tabindex="-1">
  <div class="modal-dialog">
      <div class="modal-content">
          <div class="modal-header">
              <h5 class="modal-title">Confirmation</h5>
            <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
          </div>
          <div class="modal-body">
              <p>Do you want to save changes to this document before closing?</p>
              <p class="text-secondary"><small>If you don't save, your changes will be lost.</small></p>
          </div>
          <div class="modal-footer">
              <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cancel</button>
              <button type="button" class="btn btn-primary">Save changes</button>
          </div>
      </div>
  </div>
</div>

<script src='./js/mockupJSON.js'></script>
<script>
  
if ('serviceWorker' in navigator) {
  window.addEventListener('load', function() {
      navigator.serviceWorker.register('/js/PWA_sw.js').then(function(registration) {
          // Registration was successful
          console.log('ServiceWorker registration successful with scope: ', registration.scope);
      }, function(err) {
          // registration failed :(
          console.log('ServiceWorker registration failed: ', err);
      });
  });
}
    
</script>

<script>

  function renderAccountCard(tagCardContainer,jsonAccount={}){
    let cHTML = `
        <div class="card border-success">
          <div class="card-header signpostFlex">
            <div>
              <i class="bi-bar-chart-line-fill" style="font-size: 24px;"></i>
              <span>资产账户</span>

            </div>
            <div>
              <span>${jsonAccount.account} -CNY${jsonAccount.pl_total}}</span>
              <i class="bi-graph-up" style="color: orangered;font-size: 24px;"></i>
            </div>

          </div>

          <div class="card-body">
              <div class="table-responsive"> 
                <table class="table">
                    <thead>
                        <tr>
                            <th>ticker</th>
                            <th>Company</th>
                            <th>Shares</th>
                            <th>Cost</th>
                            <th>Price</th>
                            <th>P/L </th>
                            <th>P/L %</th>
                            <th>Value</th>
                        </tr>
                    </thead>
                    <tbody></tbody>
                </table>
            </div> 
          </div>
          <div class="card-footer text-muted signpostFlex">
            <span style="font-size: 12px;">${jsonAccount.date}</span>
            <i class="bi-info-circle"></i>
          </div>
        </div>
    ` ;

    let tagCard = document.createElement('div') ;
    tagCardContainer.appendChild(tagCard) ;
    tagCard.classList.add('col') ;
    tagCard.classList.add('falconCard') ;
    tagCard.classList.add('fcAccount') ;
    tagCard.innerHTML = cHTML ;


    let tagTBody = tagCard.querySelector('tbody') ;
    for(let i=0;i<jsonAccount.holdings.length;i++){
      let cRowHTML = `
        <td>${jsonAccount.holdings[i].ticker}</td>
        <td>${jsonAccount.holdings[i].company}</td>
        <td>${jsonAccount.holdings[i].shares}</td>
        <td>${jsonAccount.holdings[i].cost}</td>
        <td>${jsonAccount.holdings[i].price}</td>
        <td>${jsonAccount.holdings[i].pl_total}</td>
        <td>${jsonAccount.holdings[i].pl_total_percent*100}%</td>
        <td>${jsonAccount.holdings[i].value}</td>
      ` ;
      let tagRow = document.createElement('tr') ;
      tagTBody.appendChild(tagRow) ;
      tagRow.innerHTML = cRowHTML ;
    }

  }

  function renderFalconCard(tagCardContainer,jsonCard={}){
    let cCardHTML = `
      <div class="card border-success">
          <div class="card-header">Featured</div>
          <div class="card-body">
              <h5 class="card-title">NASA Launched Solar Probe</h5>
              <p class="card-text">NASA launched Parker space probe in 2018 with the mission of making observations of the outer corona of the Sun. It is the first-ever mission to "touch" the Sun.</p>
              <a href="#" class="btn btn-primary">Know more</a>
          </div>
          <div class="card-footer text-muted">3 years ago</div>
      </div>
    ` ;

    let tagFalconCard = document.createElement('div') ;
    tagCardContainer.appendChild(tagFalconCard) ;
    tagFalconCard.classList.add('col') ;
    tagFalconCard.innerHTML = cCardHTML ;
    return tagFalconCard ;

  }

function renderPortfolioCard(tagCardContainer,jsonPortfolio={}){
  let cHTML = `
        <div class="card border-success">
          <div class="card-header signpostFlex">
            <div>
              <i class="bi-bar-chart-line-fill" style="font-size: 24px;"></i>
              <span>纵览</span>
            </div>
            <div>
              <span>total P/L: ${jsonPortfolio.totalPL}</span>
              <i class="bi-graph-up" style="color: orangered;font-size: 24px;"></i>
            </div>
          </div>

          <div class="card-body">
              <div class="table-responsive"> 
                <table class="table">
                    <thead>
                        <tr>
                            <th>Account</th>
                            <th>Value TTM</th>
                            <th>Gain/Loss</th>
                            <th>G/L %</th>
                        </tr>
                    </thead>
                    <tbody></tbody>
                </table>
            </div> 
          </div>
          <div class="card-footer text-muted signpostFlex">
            <span style="font-size: 12px;">${jsonPortfolio.date}</span>
            <i class="bi-info-circle"></i>
          </div>
        </div>
  ` ;

  let tagCard = document.createElement('div') ;
  tagCardContainer.appendChild(tagCard) ;
  tagCard.classList.add('col') ;
  tagCard.classList.add('falconCard') ;
  tagCard.classList.add('fcPortfolio') ;
  tagCard.innerHTML = cHTML ;

  let tagTBody = tagCard.querySelector('tbody') ;
  for(let i=0;i<jsonPortfolio.accounts.length;i++){
    let cRowHTML = `
          <td>${jsonPortfolio.accounts[i].account}</td>
          <td>${jsonPortfolio.accounts[i].equityTTM}</td>
          <td>${jsonPortfolio.accounts[i].pl_day}</td>
          <td>${jsonPortfolio.accounts[i].pl_day_percent*100}%</td>
    ` ;
    let tagRow = document.createElement('tr') ;
    tagTBody.appendChild(tagRow) ;
    tagRow.innerHTML = cRowHTML ;
  }
}

function renderFalconIncomeCard(tagCardContainer,jsonIncome={}){
  let cHTML = `
        <div class="card border-success">
          <div class="card-header signpostFlex">
            <div>
              <i class="bi-currency-exchange" style="font-size: 24px;"></i>
              <span>当月收入</span>
            </div>
            <div>
              <span>till ${jsonIncome.date}</span>
              <i class="bi-graph-up" style="color: orangered;font-size: 24px;"></i>
            </div>
  
          </div>
  
          <div class="card-body">
              <p class="card-text">detailed income</p>
              <div class="table-responsive overflow-auto"> 
                <table class="table">
                    <thead>
                        <tr>
                            <th>Date</th>
                            <th>Income</th>
                            <th>Source</th>
                            <th>Class</th>
                            <th>Status</th>
                        </tr>
                    </thead>
                    <tbody>
                      
                    </tbody>
                </table>
            </div> 
          </div>
          <div class="card-footer text-muted signpostFlex">
            <span style="font-size: 12px;">2023/10/29</span>
            <div>
              <i class="bi-info-circle" style="font-size: 18px;"></i>   
            </div>
          </div>
        </div>
  ` ;
  let tagCard = document.createElement('div') ;
  tagCardContainer.appendChild(tagCard) ;
  tagCard.classList.add('col') ;
  tagCard.classList.add('falconCard') ;

  tagCard.classList.add('fcMonthlyIncome') ;
  tagCard.innerHTML = cHTML ;

  let tagTblBody = tagCard.querySelector('tbody') ;

  for(let i=0;i<jsonIncome.incomes.length;i++){
    let tagRow = document.createElement('tr') ;
    tagTblBody.appendChild(tagRow) ;
    tagRow.innerHTML=`
          <tr>
            <td>${jsonIncome.incomes[i].date}</td>
            <td>${jsonIncome.incomes[i].currency} ${jsonIncome.incomes[i].income}</td>
            <td>${jsonIncome.incomes[i].source}</td>
            <td>${jsonIncome.incomes[i].class}</td>
            <td>${jsonIncome.incomes[i].status}</td>
          </tr>
    ` ;
    if(jsonIncome.incomes[i].status!='collected'){
      tagRow.style.color="blue" ;
    }
  }
}


function renderExpenditureCard(tagCardContainer,jsonExpenditure={}){
  let cHTML = `
  <div class="card border-success">
          <div class="card-header signpostFlex">
            <div>
              <i class="bi-currency-exchange" style="font-size: 24px;"></i>
              <span>月度支出</span>
              </div>
            <div>
              <span>till 2023/10/21</span>
              <i class="bi-graph-up" style="color: orangered;font-size: 24px;"></i>
            </div>
  
          </div>
  
          <div class="card-body">
              <div class="table-responsive"> 
                <table class="table">
                    <thead>
                        <tr>
                            <th>date</th>
                            <th>pay for</th>
                            <th>class</th>
                            <th>regular?</th>
                            <th>amount</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td>2023/10/21</td>
                            <td>Gasline</td>
                            <td>transportation</td>
                            <td>none</td>
                            <td>THB1052.00</td>
                        </tr>                          
                    </tbody>
                </table>
            </div> 
          </div>
          <div class="card-footer text-muted signpostFlex">
            <span style="font-size: 12px;">${jsonExpenditure.date}</span>
            <div>
            <i class="bi-plus-square falconButton" id="idBTNNewSpending"></i>   
            <i class="bi-check-square"></i>         
          </div>
          </div>
        </div>
  ` ;
  let tagCard = document.createElement('div') ;
  tagCardContainer.appendChild(tagCard) ;
  tagCard.classList.add('col') ;
  tagCard.classList.add('falconCard') ;
  tagCard.classList.add('fcExpenditure') ;
  tagCard.innerHTML = cHTML ;

  let tagTblBody = tagCard.querySelector('tbody') ;

  for(let i=0;i<jsonExpenditure.expenditures.length;i++){
    let tagRow = document.createElement('tr') ;
    tagTblBody.appendChild(tagRow) ;
    tagRow.innerHTML=`
          <tr>
            <td>${jsonExpenditure.expenditures[i].date}</td>
            <td>${jsonExpenditure.expenditures[i].pay_for}</td>
            <td>${jsonExpenditure.expenditures[i].class}</td>
            <td>${jsonExpenditure.expenditures[i].regular}</td>
            <td>${jsonExpenditure.expenditures[i].currency} ${jsonExpenditure.expenditures[i].amount}</td>
          </tr>
    ` ;
  }
}

document.addEventListener('DOMContentLoaded',async (event)=>{
  let tagFalconCards = document.querySelector('.falconCards') ;
  tagFalconCards.innerHTML = '' ;
  
  renderPortfolioCard(tagFalconCards,jsonGlobalPortfolio) ;
  renderAccountCard(tagFalconCards,jsonGlobalAccount) ;

  let jsonURL = `http://127.0.0.1:8080/json?mm=07`;
  const response = await fetch(jsonURL);
  const jsonIncomeStream = await response.json();
  console.log(JSON.stringify(jsonIncomeStream,null,3)) ;
  renderFalconIncomeCard(tagFalconCards,jsonIncomeStream/*jsonGlobalIncome*/) ;

  renderExpenditureCard(tagFalconCards,jsonGlobalExpenditure) ;
  let tagBTN= document.querySelector('#idBTNNewSpending') ;
  tagBTN.addEventListener('click',(event)=>{
    var myModal = new bootstrap.Modal(document.getElementById('myModal'))
    myModal.show();
  }) ;

}) ;


</script>
</body>
</html>